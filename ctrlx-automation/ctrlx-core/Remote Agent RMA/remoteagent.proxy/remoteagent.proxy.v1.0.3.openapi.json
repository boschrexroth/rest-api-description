{
  "openapi" : "3.0.0",
  "info" : {
    "contact" : {
      "email" : "support@boschrexroth.com",
      "name" : "Bosch Rexroth Support",
      "url" : "https://www.boschrexroth.com"
    },
    "description" : "This is the state api for remote agent proxy (RDA proxy). The remote agent will receive state information from subcomponents (command state, device state)",
    "title" : "ctrlX Device Portal Agent - Proxy API",
    "version" : "1.0.3"
  },
  "servers" : [ {
    "description" : "API is without subroute - call will be done to a unix socket",
    "url" : "{protocol}://{host}/api/v1",
    "variables" : {
      "host" : {
        "default" : "localhost:443",
        "description" : "Server host name"
      },
      "protocol" : {
        "default" : "https",
        "description" : "Protocol of the server",
        "enum" : [ "http", "https" ]
      }
    }
  } ],
  "tags" : [ {
    "description" : "This path handles commands.",
    "name" : "Commands"
  }, {
    "description" : "This path shows the state of a device.",
    "name" : "State"
  }, {
    "description" : "This path handles sse.",
    "name" : "Events"
  } ],
  "paths" : {
    "/commands" : {
      "get" : {
        "description" : "Gets a list of all received commands",
        "operationId" : "getCommands",
        "responses" : {
          "200" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Commands"
                }
              }
            },
            "description" : "List of commands"
          },
          "400" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Problem"
                }
              }
            },
            "description" : "The request is incomplete or malformed."
          },
          "404" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Problem"
                }
              }
            },
            "description" : "The resource was not found."
          }
        },
        "tags" : [ "Commands" ]
      },
      "post" : {
        "description" : "Creates a new command",
        "operationId" : "createCommand",
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/Command"
              }
            }
          }
        },
        "responses" : {
          "204" : {
            "description" : "Command created"
          },
          "400" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Problem"
                }
              }
            },
            "description" : "The request is incomplete or malformed."
          }
        },
        "tags" : [ "Commands" ]
      }
    },
    "/commands/{commandId}" : {
      "get" : {
        "description" : "Gets the selected command",
        "operationId" : "getCommand",
        "parameters" : [ {
          "description" : "The command Id.",
          "explode" : false,
          "in" : "path",
          "name" : "commandId",
          "required" : true,
          "schema" : {
            "example" : "snap_vlc_v3.0.1-1-3-gd3dasf0",
            "type" : "string"
          },
          "style" : "simple"
        } ],
        "responses" : {
          "200" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Command"
                }
              }
            },
            "description" : "Selected command"
          },
          "404" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Problem"
                }
              }
            },
            "description" : "The resource was not found."
          }
        },
        "tags" : [ "Commands" ]
      }
    },
    "/events" : {
      "get" : {
        "description" : "This command open an sse channel to get an event stream of command state and/or device state updates.\nIf the command is supported, no \"response\" is returned - the sse channel is open! Via this channel command states and device states are transfered.\nIf the command is not supported by the server (response 501 or 404), the client switches to polling /status and /commands/{commandId} to get device state and/or command state updates\n",
        "operationId" : "getEvents",
        "responses" : {
          "204" : {
            "description" : "Successful"
          },
          "404" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Problem"
                }
              }
            },
            "description" : "The resource was not found."
          },
          "501" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Problem"
                }
              }
            },
            "description" : "The resource is not implemented."
          }
        },
        "summary" : "Gets a stream of command state and/or device state updates - NOT SUPPORTED BY SWAGGER!!!!",
        "tags" : [ "Events" ]
      }
    },
    "/status" : {
      "get" : {
        "description" : "Gets an array of device state updates",
        "operationId" : "getStatus",
        "responses" : {
          "200" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/States"
                }
              }
            },
            "description" : "State channel opened"
          },
          "404" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Problem"
                }
              }
            },
            "description" : "The resource was not found."
          }
        },
        "summary" : "Gets array of device states",
        "tags" : [ "State" ]
      }
    }
  },
  "components" : {
    "parameters" : {
      "commandId" : {
        "description" : "The command Id.",
        "explode" : false,
        "in" : "path",
        "name" : "commandId",
        "required" : true,
        "schema" : {
          "example" : "snap_vlc_v3.0.1-1-3-gd3dasf0",
          "type" : "string"
        },
        "style" : "simple"
      }
    },
    "responses" : {
      "BadRequest" : {
        "content" : {
          "application/json" : {
            "schema" : {
              "$ref" : "#/components/schemas/Problem"
            }
          }
        },
        "description" : "The request is incomplete or malformed."
      },
      "NotFound" : {
        "content" : {
          "application/json" : {
            "schema" : {
              "$ref" : "#/components/schemas/Problem"
            }
          }
        },
        "description" : "The resource was not found."
      },
      "NotImplemented" : {
        "content" : {
          "application/json" : {
            "schema" : {
              "$ref" : "#/components/schemas/Problem"
            }
          }
        },
        "description" : "The resource is not implemented."
      }
    },
    "schemas" : {
      "Command" : {
        "additionalProperties" : {
          "type" : "string"
        },
        "example" : {
          "details" : "Command not executable",
          "id" : "EizHcFUrEemoEe7uCv8vCQ",
          "cmd" : "BACKUP",
          "state" : "SUCCESSFUL",
          "target" : "urn:bosch:deviceportal:id:ctrlXCORE.seq.1234567890#SOFTWARE.name.rexroth-test"
        },
        "properties" : {
          "id" : {
            "description" : "Unique identifier of the command in the backend.",
            "example" : "EizHcFUrEemoEe7uCv8vCQ",
            "type" : "string"
          },
          "cmd" : {
            "description" : "App specific command (not hardly known by remote agent)",
            "example" : "BACKUP",
            "type" : "string"
          },
          "state" : {
            "$ref" : "#/components/schemas/CommandState"
          },
          "target" : {
            "description" : "The target address including software identifier for command",
            "example" : "urn:bosch:deviceportal:id:ctrlXCORE.seq.1234567890#SOFTWARE.name.rexroth-test",
            "type" : "string"
          },
          "details" : {
            "description" : "The details for a command status e. g. error details",
            "example" : "Command not executable",
            "type" : "string"
          }
        },
        "required" : [ "cmd", "id", "target" ],
        "type" : "object"
      },
      "Commands" : {
        "items" : {
          "$ref" : "#/components/schemas/Command"
        },
        "type" : "array"
      },
      "State" : {
        "example" : {
          "categoryName" : "DEVICE",
          "properties" : [ {
            "name" : "firmwareVersion",
            "list" : [ "{}", "{}" ],
            "value" : "1.2",
            "ts" : 0
          }, {
            "name" : "firmwareVersion",
            "list" : [ "{}", "{}" ],
            "value" : "1.2",
            "ts" : 0
          } ]
        },
        "properties" : {
          "categoryName" : {
            "description" : "The state of the app. See https://inside-docupedia.bosch.com/confluence/display/IDM/Nexeed+Device+Portal+-+Standard+Device+Categories",
            "example" : "DEVICE",
            "type" : "string"
          },
          "properties" : {
            "items" : {
              "$ref" : "#/components/schemas/Measurement"
            },
            "type" : "array"
          }
        },
        "type" : "object"
      },
      "States" : {
        "items" : {
          "$ref" : "#/components/schemas/State"
        },
        "type" : "array"
      },
      "Problem" : {
        "description" : "This document defines a \"problem detail\" as a way  to carry machine-readable details of errors in a  HTTP response to avoid the need to define new error  response formats for HTTP APIs.\n",
        "properties" : {
          "type" : {
            "default" : "about:blank",
            "description" : "A URI reference [RFC3986] that identifies the problem type. \nThis specification encourages that, when dereferenced, \nit provide human-readable documentation for the problem type \n(e.g., using HTML [W3C.REC-html5-20141028]). When this member \nis not present, its value is assumed to be \"about:blank\".\n",
            "example" : "https://example.com/probs/out-of-credit",
            "format" : "uri",
            "type" : "string"
          },
          "title" : {
            "description" : "A short, human-readable summary of the problem type. \nIt SHOULD NOT change from occurrence to occurrence of the problem, \nexcept for purposes of localization (e.g., using proactive content \nnegotiation; see [RFC7231], Section 3.4).\nIf the response is a diagnostics message, it contains \nthe text associated with the mainDiagnosisCode.\n",
            "example" : "You do not have enough credit.",
            "type" : "string"
          },
          "status" : {
            "description" : "The HTTP status code ([RFC7231], Section 6) generated by the \norigin server for this occurrence of the problem.\n",
            "example" : 403,
            "format" : "int32",
            "type" : "integer"
          },
          "detail" : {
            "description" : "A human-readable explanation specific to this occurrence of the problem.\nIf the response is a diagnostics message, it contains the text associated with\nthe detailedDiagnosisCode.\n",
            "example" : "Your current balance is 30, but that costs 50.",
            "type" : "string"
          },
          "instance" : {
            "description" : "A URI reference that identifies the specific occurrence of the problem.\nIt may or may not yield further information if dereferenced.\n",
            "example" : "/account/12345/msgs/abc",
            "type" : "string"
          },
          "code" : {
            "deprecated" : true,
            "description" : "An error code issued by the system that caused the original problem.\nThis code can be used to track down the root cause of the error.\n",
            "example" : "F360001",
            "type" : "string"
          },
          "mainDiagnosisCode" : {
            "description" : "The main diagnosis code is issued by the system that caused the problem.\nThis code can be used to track down the root cause and source of the error.\nIt can be used to search in the documentation for a solution.\nIt SHOULD NOT change from occurrence to occurrence of the same problem.\n",
            "example" : "080F0100",
            "type" : "string"
          },
          "detailedDiagnosisCode" : {
            "description" : "The detailed diagnosis code issued by the system that caused the problem.\nThis code can be used to track down the detailed cause and source of the error.\nIt can be used to search in the documentation for a solution.\nThe detailed diagnosis code gives additional information about the cause of the error.\nIt SHOULD NOT change from occurrence to occurrence of the same problem.\n",
            "example" : "00666001",
            "type" : "string"
          },
          "dynamicDescription" : {
            "description" : "A dynamic description gives detailed information about the occurrence of a problem.\nIt can change between different occurrences of the same error.\n",
            "example" : "value = -4.5",
            "type" : "string"
          },
          "severity" : {
            "description" : " Severity of a problem as defined RFC5424 of the Syslog standard, see https://tools.ietf.org/html/rfc5424",
            "enum" : [ "Emergency", "Alert", "Critical", "Error", "Warning", "Notice", "Informational", "Debug" ],
            "example" : "Error",
            "type" : "string"
          },
          "links" : {
            "description" : "Collection of links to fix the problem. E.g. links to online user manual,\nto an online community (using tags) or a developer chat (e.g. Slack).\n",
            "items" : {
              "example" : "https://stackoverflow.com/questions/tagged/boschrexroth+controlx+f360001",
              "format" : "uri",
              "type" : "string"
            },
            "type" : "array"
          },
          "moreInfo" : {
            "additionalProperties" : true,
            "description" : "The moreInfo field allows you to add additional information that might be necessary to debug or trace down the cause of an error.\nIt might also contain information what is needed to resolve the problem.\nThere are loosely specified fields for specific problems that can be used in these situations, e.g.:\n- On a 403 Forbidden error: The moreInfo can contain a field \"requiredPermissions\" with the required permissions seperated by comma\n- On a 402 Payment required: The moreInfo can contain a field \"requiredLicenses\" with the required licenses seperated by comma\n",
            "example" : {
              "trace" : "ExampleClass.cpp#452 Null pointer exception",
              "class" : "ExampleClass"
            },
            "type" : "object"
          },
          "cause" : {
            "description" : "Sometimes a problem might be caused by problems that occure in other components or are the root cause of a problem. In this\ncase the related problems can be added as a cause. Since it might be possible that multiple components have problems on a single\naction, cause is an array. E.g. Loading failed because several components where not able to load the configuration.\n",
            "items" : {
              "$ref" : "#/components/schemas/Problem"
            },
            "type" : "array"
          }
        },
        "required" : [ "title", "type" ],
        "type" : "object",
        "x-version" : "1.0.0"
      },
      "CommandState" : {
        "description" : "List of all possible command states",
        "enum" : [ "CREATED", "CANCELED", "TRANSMITTED", "ACCEPTED", "REJECTED", "FAILED", "SUCCESSFUL" ],
        "example" : "SUCCESSFUL",
        "readOnly" : true,
        "type" : "string"
      },
      "Measurement" : {
        "example" : {
          "name" : "firmwareVersion",
          "list" : [ "{}", "{}" ],
          "value" : "1.2",
          "ts" : 0
        },
        "properties" : {
          "name" : {
            "description" : "Name of the measurement",
            "example" : "firmwareVersion",
            "type" : "string"
          },
          "value" : {
            "description" : "Simple value of the measurement. Use this if your measurement consists of only one single value. Has higher priority than \\\"list\\ (i.e., if \\\"value\\\" and \\\"list\\\" are provided \\\"value\\\" will be stored).\"",
            "example" : "1.2",
            "type" : "string"
          },
          "list" : {
            "description" : "A list of measurements which are represented by JSON objects. Use this if your measurement consists of multiple or single JSON objects. Has lower priority than \\\"value\\ (i.e., if \\\"value\\\" and \\\"list\\\" are provided \\\"value\\\" will be stored).",
            "items" : {
              "type" : "object"
            },
            "type" : "array"
          },
          "ts" : {
            "description" : "The time when the value was measured. (Epoch/Unix Timestamp: either in seconds or milliseconds since 1970). This value is used to identify newer values (If not specified, the reception time is used).'",
            "type" : "integer"
          }
        },
        "type" : "object"
      }
    }
  }
}